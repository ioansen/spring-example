<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Employees</title>
    <link rel="stylesheet" type="text/css" href="/css/table.css">
    <link rel="stylesheet" type="text/css" href="/css/button.css">
    <script src = "https://ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>
</head>
<body>
    <div ng-app = "main" ng-controller = "employeeController">

        <table>
            <tr>
                <th>Emp ID</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Salary</th>
                <th>Department</th>
                <th>Job</th>
            </tr>

            <tr ng-repeat = "e in employees">
                <td>{{ e.id }}</td>
                <td>{{ e.name }}</td>
                <td>{{ e.lastname }}</td>
                <td>{{ e.salary }}</td>
                <td>{{ e.dep }}</td>
                <td>{{ e.job }}</td>
                <td style="display: inline-block;">
                    <a class = "button_table" href="/ang/addEmployee.html?id={{e.id}}&action=Modify">Modify</a>
                    <button class = "button_table" ng-click="delete(e)">Delete</button>
                </td>
            </tr>

            <script>
                var mainApp = angular.module("main", []);

                mainApp.controller('employeeController', function ($scope,$http) {
                    var url = "http://localhost:8080/rest/employees";

                    $http.get(url).then( function(response) {
                        $scope.employees = response.data;
                    });
                    
                    $scope.delete = function (employee) {
                        var url = "http://localhost:8080/rest/employees/" + employee.id;

                        $http.delete(url).then( function(response) {
                            console.log(response);
                            var index = $scope.employees.indexOf(employee);
                            $scope.employees.splice(index,1);
                        });
                    }
                });
            </script>

        </table>
        <br><br>
        <a href="/ang/addEmployee.html?action=Add" class="button">Add employee</a><br><br>
    </div>
</body>
</html>